(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();let b=[];function ce(e){b=[...e]}function re(e,t,n){b=[];let s=t;for(;s!==0;){const i=_(0,e.length-1),a=_(0,e[0].length-1);!e[i][a].isBomb&&e[i][a]!==n&&(b.push({y:i,x:a}),e[i][a].setBomb(),s--)}}function P({y:e,x:t}){var s,i,a,c,p,d,u,m;return[(s=l[e-1])==null?void 0:s[t],(i=l[e-1])==null?void 0:i[t+1],(a=l[e])==null?void 0:a[t+1],(c=l[e+1])==null?void 0:c[t+1],(p=l[e+1])==null?void 0:p[t],(d=l[e+1])==null?void 0:d[t-1],(u=l[e])==null?void 0:u[t-1],(m=l[e-1])==null?void 0:m[t-1]]}function _(e,t){return Math.floor(Math.random()*(t-e+1)+e)}let x=0;function de(e){x=e}function $(e){const t=P(e.coords),n=t.filter(s=>s===1||(s==null?void 0:s.isBomb));t.filter(s=>s).forEach(s=>{!s.isBomb&&!s.isOpen&&n.length===0&&(s.open(),$(s))})}function z(){l.map(e=>{e.map(t=>{t.disableCell()})})}function O(e=!1){sessionStorage.setItem("saveField",JSON.stringify(!e&&l)),sessionStorage.setItem("bombsCells",JSON.stringify(!e&&(JSON.parse(sessionStorage.getItem("bombsCells"))||(b.length===0?!1:b))))}function me(){(JSON.parse(sessionStorage.getItem("bombsCells"))||b).map(({y:e,x:t})=>{l[e][t].open(!0)}),xe(),z(),O(!0)}function ue(){x++,O(),l.length*l[0].length-x===JSON.parse(sessionStorage.getItem("bombsCells")).length&&(Ce(),z(),O(!0))}function o({tagName:e,classList:t,id:n,type:s,forAttr:i,value:a,name:c,checked:p,disabled:d,textContent:u,innerHTML:m}){const r=document.createElement(e);return t!==void 0&&r.classList.add(...t.filter(Boolean)),n!==void 0&&(r.id=n),s!==void 0&&(r.type=s),i!==void 0&&r.setAttribute("for",i),c!==void 0&&(r.name=c),a!==void 0&&r.setAttribute("value",a),p!==void 0&&(r.checked=p),d!==void 0&&(r.disabled=d),u!==void 0&&(r.textContent=u),m!==void 0&&(r.innerHTML=m),r}class ge{constructor(t,n,s,i=!1){this.coords=t,this.isBomb=n,this.isOpen=s,this.isFlagged=i,this.clickHandler=this.handleCellClick.bind(this),this.contextmenuHandler=a=>{a.preventDefault();const c=a.target.textContent;this.isFlagged=!this.isFlagged,a.target.textContent=this.isOpen?c:this.setFlag()}}setBomb(){this.isBomb=!0}setFlag(){this.isFlagged?(this.cell.classList.add("flagged"),M(-1)):(this.cell.classList.remove("flagged"),M(1)),O()}setCellContent(){const t=P(this.coords);this.setDOMValue(t.filter(n=>n==null?void 0:n.isBomb).length)}setClass(t){switch(t.type){case"add":this.cell.classList.add(t.payload);break;case"remove":this.cell.classList.remove(t.payload);break;case"toggle":this.cell.classList.toggle(t.payload);break}}open(t=!1){x===0&&!JSON.parse(sessionStorage.getItem("bombsCells"))&&(ie(),re(l,H,this)),this.cell.classList.add("open"),this.isOpen=!0,this.setCellContent(),this.isBomb||ue(),t||$(this)}handleCellClick(){this.isFlagged||this.isOpen||(ke(),this.isBomb?me():this.open())}setDOMValue(t){if(this.cell.classList.contains("open")){if(this.isBomb)return this.cell.classList.add("mine");this.cell.textContent=t||"",this.cell.classList.add(`value-${t}`)}}disableCell(){this.cell.removeEventListener("click",this.clickHandler),this.cell.removeEventListener("contextmenu",this.contextmenuHandler),this.setClass({type:"add",payload:"disabled"})}createCellOnField(){return this.cell=o({tagName:"div",classList:["cell"]}),this.isOpen&&this.open(),this.isFlagged&&this.setFlag(),this.cell.addEventListener("click",this.clickHandler),this.cell.addEventListener("contextmenu",this.contextmenuHandler),this.setCellContent(),this.cell}}const Q=o({tagName:"div",id:"app"}),V=o({tagName:"div",classList:["wrapper"]}),W=o({tagName:"div",classList:["menu"]}),y=JSON.parse(sessionStorage.getItem("timer")),w=o({tagName:"div",classList:["stopwatch","menu__text"],textContent:C(y||0)}),Y=o({tagName:"div",classList:["menu__btn"]}),G=o({tagName:"div",classList:["menu__text"]}),h=o({tagName:"div",classList:["click-count"]}),k=o({tagName:"div",classList:["remaining-bombs"]}),K=o({tagName:"div",classList:["option-box"]}),S=o({tagName:"div",classList:["modal-box","hidden"]}),L=o({tagName:"div",classList:["modal-box__content"],textContent:"Settings"}),U=o({tagName:"div",classList:["settings-btn","btn"],textContent:"Settings"}),j=o({tagName:"div",classList:["last-results-btn","btn"],textContent:"Results"});S.append(L);K.append(S,U,j);const E=o({tagName:"div",classList:["game-modes"]}),fe=o({tagName:"span",classList:["game-mode","easy-mode"],textContent:"EASY"}),he=o({tagName:"span",classList:["game-mode","medium-mode"],textContent:"MEDIUM"}),pe=o({tagName:"span",classList:["game-mode","hard-mode"],textContent:"HARD"});E.append(fe,he,pe);E.addEventListener("click",be);let g=JSON.parse(sessionStorage.getItem("mode"))||"easy-mode";const X={"easy-mode":[10,10,10],"medium-mode":[15,15,40],"hard-mode":[25,25,99]};function be(e){e.target.classList.contains("easy-mode")&&(g="easy-mode"),e.target.classList.contains("medium-mode")&&(g="medium-mode"),e.target.classList.contains("hard-mode")&&(g="hard-mode"),sessionStorage.setItem("mode",JSON.stringify(g)),oe()}const B=o({tagName:"div",classList:["field"]});G.append(h,k);W.append(w,Y,G);V.append(W,B);Q.append(K,E,V);document.body.append(Q);U.addEventListener("click",e=>F(e,"settings"));j.addEventListener("click",e=>F(e,"results"));S.addEventListener("click",e=>F(e));const J=document.documentElement;let{soundIsOn:v,theme:N}=JSON.parse(localStorage.getItem("settings"))||{soundIsOn:!0,theme:"light"};const Z=[{name:"Sound",className:["sound-setting-item"],options:[{text:"On",value:!0,className:[v?"active":""],handle:q},{text:"Off",value:!1,className:[v?"":"active"],handle:q}]},{name:"Theme",className:["theme-setting-item"],options:[{text:"Light",value:"light",className:[N==="light"?"active":""],handle:D},{text:"Dark",value:"dark",className:[N==="dark"?"active":""],handle:D}]}];let ee=te();function te(){var e;return(e=JSON.parse(localStorage.getItem("last-results")))==null?void 0:e.queue.map(t=>({name:t.mode,className:["last-results-item"],options:[{text:C(t.time),value:t.time,className:[]},{text:t.clicks,value:t.clicks,className:[]}]}))}N==="dark"&&J.style.setProperty("--main-color","#373737");function I(e){v&&e.play()}function q(e,t){e.getAttribute("value")==="true"&&(v=!0),e.getAttribute("value")==="false"&&(v=!1),se(e,t,"Sound")}function D(e,t){e.getAttribute("value")==="dark"&&(J.style.setProperty("--main-color","#373737"),N="dark"),e.getAttribute("value")==="light"&&(console.log("theme",e,t),J.style.setProperty("--main-color","#fff"),N="light"),se(e,t,"Theme")}function se(e,t,n){e.classList.add("active"),Z.filter(s=>s.name===n)[0].options.map(s=>{s.text===e.textContent?s.className.push("active"):s.className.pop()});for(let s=1;s<t.length;s++)e!==t[s]&&t[s].classList.remove("active");localStorage.setItem("settings",JSON.stringify({soundIsOn:v,theme:N}))}function R(e,t){const n=o({tagName:"div",classList:["content-box-item",...t.className||""]}),s=o({tagName:"div",className:"option-title",textContent:t.name});t.options.forEach(i=>{const a=o({tagName:"div",classList:["option-item",...i.className||""],value:i.value,textContent:i.text});i.handle&&a.addEventListener("click",()=>{i.handle(a,n.children)}),n.append(a)}),n.prepend(s),e.append(n)}function F(e,t){e.target.classList.contains("modal-box")?S.classList.add("hidden"):(t==="settings"&&(L.innerHTML="",Z.forEach(n=>R(L,n))),t==="results"&&(L.innerHTML="",ee.forEach(n=>R(L,n))),S.classList.remove("hidden"))}const ve=new Audio("/src/assets/sounds/lose.mp3"),Ne=new Audio("/src/assets/sounds/win.mp3"),Le=new Audio("/src/assets/sounds/click.mp3"),Se=new Audio("/src/assets/sounds/tick.mp3");function Ce(){I(Ne),ye({mode:g,time:f,clicks:h.textContent}),ne("win",`Hooray! You found all mines in ${f} seconds and ${h.textContent} moves!`)}function xe(){I(ve),ne("lose","Game over. Try again")}class Oe{constructor(t,n){this.maxSize=n,this.queue=t||[]}add(t){if(this.queue.unshift(t),this.maxSize<this.queue.length)return this.queue.pop()}getQueue(){return this.queue}}function ye(e){const{maxSize:t,queue:n}=JSON.parse(localStorage.getItem("last-results"))||{maxSize:3,queue:[]},s=new Oe(n,t);s.add(e),localStorage.setItem("last-results",JSON.stringify(s)),ee=te()}function ne(e,t){ae();const n=o({tagName:"div",classList:["message-box","hidden"]}),s=o({tagName:"div",classList:["message-box__text"]});n.append(s),n.classList.remove("hidden"),s.classList.add(e),s.textContent=t,B.prepend(n),sessionStorage.setItem("count-clicks",JSON.stringify(0)),sessionStorage.setItem("timer",JSON.stringify(0))}Y.addEventListener("click",()=>oe());let f=y||0,A=null;y&&ie();function ie(){A=setInterval(()=>{f++,w.textContent=C(f),sessionStorage.setItem("timer",JSON.stringify(f))},1e3)}function ae(){clearInterval(A),A=null}function ke(){I(Le);const e=+h.textContent+1;h.textContent=e,sessionStorage.setItem("count-clicks",JSON.stringify(e))}function M(e){I(Se),k.textContent=+k.textContent+e}let l=[],H=0;function C(e){const t=Math.floor(e/60).toString(),n=(e-+t*60).toString();return`${t.length===1?`0${t}`:t}:${n.length===1?`0${n}`:n}`}function oe(){ae(),B.innerHTML="",sessionStorage.setItem("saveField",JSON.stringify(!1)),sessionStorage.setItem("bombsCells",JSON.stringify(!1)),sessionStorage.setItem("count-clicks",JSON.stringify(0)),sessionStorage.setItem("timer",JSON.stringify(0)),f=0,l=[],H=0,ce([]),h.textContent=0,k.textContent=0,w.textContent=C(f),de(0),le(...X[g])}function le(){const[e,t,n]=X[g];h.textContent=JSON.parse(sessionStorage.getItem("count-clicks"))||0,M(n),Be(e,t,n)}function Be(e,t,n){const s=JSON.parse(sessionStorage.getItem("saveField"));l=s||Array.from({length:t},()=>Array.from({length:e},()=>0)),H=n,l.map((i,a)=>{const c=o({tagName:"div",classList:["line-cells"]});B.append(c),i.map((p,d)=>{var m,r,T;const u=Ie({y:a,x:d},((m=s==null?void 0:s[a])==null?void 0:m[d].isBomb)||!1,((r=s==null?void 0:s[a])==null?void 0:r[d].isOpen)||!1,((T=s==null?void 0:s[a])==null?void 0:T[d].isFlagged)||!1);c.append(u)})})}function Ie({y:e,x:t},n,s,i){const a=new ge({y:e,x:t},!!n,!!s,!!i);return l[e][t]=a,a.createCellOnField()}le();
